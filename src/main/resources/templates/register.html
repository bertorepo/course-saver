<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
	
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta name="description" content="" />
	<meta name="author" content="" />
	<title>Register</title>
	<link rel="stylesheet" type="text/css" href="/css/app/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="/css/app/font-awesome.min.css">
	<script th:src="@{/js/app/jquery-3.5.1.js}"></script>
	<script th:src="@{/js/app/popper.min.js}"></script>
	<script th:src="@{/js/app/bootstrap.min.js}"></script>
	
	<script th:src="@{/js/app/jquery-ui.js}"></script>
	<link rel="stylesheet" type="text/css" href="/css/app/jquery-ui.css">
	<style type="text/css">   
	    /* Chrome, Safari, Edge, Opera */
	    input::-webkit-outer-spin-button,
	    input::-webkit-inner-spin-button {
	      -webkit-appearance: none;
	      margin: 0;
	    }
	   
	    /* Firefox */
	    input[type=number] {
	      -moz-appearance: textfield;
	    }
	    input[type="submit"] {
		  background: #5cb85c;
		  color: #fff;
		  transition: background 600ms;
		  cursor: pointer;
		}
		
		input[type="submit"]:disabled {
		  background: #555;
		  cursor: not-allowed;
		}
	</style>
</head>

<body>
	<script type="text/javascript">
		$(function() {
		   $( "#employmentDate" ).datepicker({
			   dateFormat: "yy-mm-dd",
			   maxDate: new Date(),
			   changeYear: true,
			   yearRange: "1975:+nn",
		   }).datepicker("setDate", new Date());
		 });
 	</script>
 	
 	<!--Start Update to disable submit button-->
 	<script type="text/javascript">
	 	$(function(){
	 		 function submitState(el) {
	
	 		    var $form = $(el),
		        $requiredInputs = $form.find('input:required'),
		        $requiredSelect = $form.find('select:required'),
		        $submit = $form.find('input[type="submit"]');
		    
		    	$submit.attr('disabled', 'disabled');
	
	 		    $requiredInputs.keyup(function () {
		 		      $form.data('empty', 'false');
		 		      
		 		      $requiredInputs.each(function() {
		 		        if ($(this).val() === '') {
		 		          $form.data('empty', 'true');
		 		        }
		 		      });
		 		      
		 		    
		 		      if ($form.data('empty') === 'true') {
		 		        $submit.attr('disabled', 'disabled').attr('title', 'Fill in all required fields');
		 		      } else {
		 		    	 $requiredSelect.change(function() {
			 		        if ($(this).val() === '') {
			 		          $form.data('empty', 'true');
			 		        }else {
			 		        	$submit.removeAttr('disabled').attr('title', 'Click to submit');
			 		        }
			 		      });
		 		      }
		 		    });
	 		  }
	 		 
	 		  submitState('#sign_up_user');
	 		});
	 </script>
    <!--End Update to disable submit button-->
 	
	<div th:replace="fragments/general :: header2"> </div>
	
	<main role="main" class="container">
		<div class="container mt-5 col-lg-5">
			<div class="card mb-5 border-0">
				<div class="card-body p-0 row">
					<form id="sign_up_user" class="form-horizontal col-lg-12" th:action="@{/register/createNewMember}" method="post">
						<h4 class="text-center font-weight-bold">User does not exist</h4>
						<hr class="row">
						<div class="form-group row">
							<label class="font-italic">Please fill out the form to register</label>
						</div>
						<div class="form-group row">
							<label class="col-sm-4 control-label col-form-label pl-0">ID Number</label>
							<div class="col-sm-8 pl-0 pr-0">
								<input 
									type="number" 
								    class="form-control" 
								    id="id" 
								    name="id" 
								    placeholder="Type a number"
								    pattern="/^-?\d+\.?\d*$/" 
								    oninput="this.value = this.value.replace(/[^a-z0-9\s]/gi, ''); this.value = this.value.replace(/(\..*)\./g, '$1');" 
								    onKeyDown="if(this.value.length==10 && event.keyCode!=8) return false;" autofocus required>
							</div>
						</div>
						<div class="form-group row">
							<label class="col-sm-4 control-label col-form-label pl-0">First Name</label>
							<div class="col-sm-8 pl-0 pr-0">
								<input type="text" class="form-control" id="firstName" name="firstName" th:maxlength="50" required>
							</div>
						</div>
						<div class="form-group row">
							<label class="col-sm-4 control-label col-form-label pl-0">Last Name</label>
							<div class="col-sm-8 pl-0 pr-0">
								<input type="text" class="form-control" id="lastName" name="lastName" th:maxlength="50" required>
							</div>
						</div>
						<div class="form-group row">
							<label class="col-sm-4 control-label col-form-label pl-0">Username</label>
							<div class="col-sm-8 pl-0 pr-0">
								<input th:value="${username}" type="text" id="userName" name="userName" class="form-control" th:maxlength="50" disabled>
							</div>
						</div>
						<div class="form-group row">
							<label class="col-sm-4 control-label col-form-label pl-0">Email Address</label>
							<div class="col-sm-8 pl-0 pr-0">
								<input th:value="${username + '@fujitsu.com'}" type="email" class="form-control" id="emailAddress" name="emailAddress" th:maxlength="50" required>
							</div>
						</div>
						<div class="form-group row">
							<label class="col-sm-4 control-label col-form-label pl-0">Department</label>
							<div class="col-sm-8 pl-0 pr-0">
								<select class="form-control" id="departmentid" name="departmentid" required>
									<option disabled selected></option>
									<option th:each="department : ${departmentList}" th:value="${department.id}" th:text="${department.department}"></option>
								</select>
							</div>
						</div>
						<div class="form-group row">
							<label class="col-sm-4 control-label col-form-label pl-0">Employment Date</label>
							<div class="col-sm-8 pl-0 pr-0">
								<input type="text" class="form-control" id="employmentDate" name="employmentDate" style="background:#FFFFFF" readonly>
							</div>
						</div>
						<div class="form-group text-center" style="padding-top:5%">					
							<input type="submit" class="btn btn-primary w-25" value="Register">
							<a th:href="@{/login}" class="btn btn-danger w-25">Cancel</a>
						</div>
						
						<!--Success Modal-->
						<div class="modal fade" id="successModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
							<div class="modal-dialog modal-sm text-center modal-dialog-centered">
								<div class="modal-content">
									<div class="modal-header alert-primary">
										<h5 class="modal-title text-white">Success!</h5>
										<a th:href="@{/login}" class="close" aria-label="Close">
											<span aria-hidden="true" class="text-white">&times;</span>
										</a>
									</div>
									<div class="modal-body">
										<div class="form-group row">
											<label class="col-lg-12 col-form-label">You are now registered!</label>
										</div>	
										<div class="modal-footer d-flex justify-content-center">
												<a th:href="@{/login}" class="btn btn-primary">OK</a>
										</div>
									</div>
								</div>
							</div>
						</div>
						<!--Success Modal End-->
						
						<!--Registration Modal-->
						<div class="modal fade" id="registerModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
							<div class="modal-dialog modal-md text-center modal-dialog-centered">
								<div class="modal-content">
									<div class="modal-header alert-primary">
										<h5 class="modal-title text-white">LDAP Authentication Success!</h5>
										<a th:href="@{/register}" class="close" aria-label="Close">
											<span aria-hidden="true" class="text-white">&times;</span>
										</a>
									</div>
									<div class="modal-body">
										<div class="form-group row">
											<label class="col-md-12 col-form-label">LDAP Authentication is successful, but need to register in TS-UP database!</label>
										</div>	
										<div class="modal-footer d-flex justify-content-center">
												<a th:href="@{/register}" class="btn btn-primary">OK</a>
										</div>
									</div>
								</div>
							</div>
						</div>
						<!--Registration Modal End-->
						
					</form>
				</div>
			</div>
		</div>
	</main>
	
	<script>
		$(document).ready(function() {

			if (window.location.href.indexOf('#successModal') != -1) {
				$('#successModal').modal('show');
			}
			if (window.location.href.indexOf('#registerModal') != -1) {
				$('#registerModal').modal('show');
			}

		});
	</script>
	
	<footer th:replace="fragments/general :: footer"></footer>
</body>
</html>
